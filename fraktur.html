<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VecÄ druka</title>
    <style>
        * {
            font-family: sans-serif;
        }

        body {
            max-width: 95%;
            width: 1200px;
            margin: 0 auto;
        }

        #input {
            margin-right: .5rem;
        }

        #output {
            margin-left: .5rem;
        }

        #input,
        #output {
            margin-bottom: 1rem;
            display: block;
            width: 100%;
            font-size: 1.4rem;
            border: 1px solid #ccc;
            height: 20rem;
            line-height: 1.7rem;
            border: 1px solid navy;
            background-color: rgba(0, 0, 128, .3);
            padding: .25rem .5rem;
        }

        .combine {
            letter-spacing: -.3rem;
            padding-right: .2rem;
        }

        .columns {
            display: flex;
            width: 100%;
        }

        img {
            margin: 0 auto;
            display: block;
            max-width: 100%;
        }

        .col {
            flex: 1;
        }

        @media (max-device-width: 812px) {
            .columns {
                flex-direction: column;
                width: 95%;
            }

            #input, #output {
                margin: 1rem 0 ;
                font-size: 1rem;
                line-height: 1.2;
            }
        }
    </style>
</head>

<body>

    <h1>â„œğ”ğ”¨Å¿Ì·ğ”±ğ”¦ ğ”£ğ”¯ğ”ğ”¨ğ”±ğ”²ğ”¥ğ”¯ğ”Ì‚ ğ”´ğ”¦Å¿Ì·ğ”²ğ”¯, ğ”¨ğ”²ğ”¯ ğ”´ğ”¢ğ”¥ğ”©ğ”¢ğ”¢ğ”°</h1>

    <p>PirmajÄ lauciÅ†Ä raksti latviski kÄ ierasts. OtrajÄ lauciÅ†Ä paÅ†emsi puslÄ«dz sakarÄ«gi pÄrveidotu tekstu vecajÄ
        ortogrÄfijÄ. 100% nav, bet <em>copy-paste</em> vajadzÄ«bÄm sociÄlajos tÄ«klos vai citur bÅ«s labi.</p>

    <p>RotaÄ¼Äm - raksti pirmajÄ lodziÅ†Ä, saÅ†em otrajÄ. Nelieli komentÄri <a href="https://twitter.com/laacz">tviterÄ«
            @laacz</a>,
        garÄki uz e-pastu (laacz iekÅ¡ laacz taÅ¡ka lv) vai kÄdÄ no mesendÅ¾eriem, ja vari mani tur sasniegt.</p>

    <div class="columns">

        <textarea
            id="input">Papildu budÅ¾ets.
Ministru kabinets vakardienas sÄ“dÄ“ apsprieda papildu budÅ¾etu 1922./23. gadam un pieÅ†Ä“ma to 42.994.000 latu (2.148,7 milj. ruibÄ¼.) kopsumÄ. No tiem kÄrtejo izdevumu 19.532.00 latu un ÄrkÄrtejo 28.462.000 latu. No kÄrtejiem izdevumiem vislielakÄ suma - 16.450.000 latu - atvÄ“leta linu iepirkÅ¡anai un linu avansu samaksai. Otra lielakÄ suma - 2.108.000 latu atvÄ“leta dzelzsceÄ¼iem, galvenÄ kÄrtÄ pastiprinatÄs kustibas uztureÅ¡anai.</textarea>

        <textarea id="output"></textarea>

    </div>

    <img src="http://periodika.lv/periodika2-viewer/view/img/block?block=P1_TB00008&issue=/p_001_lavs1923n026&article=DIVL13&quality=&doctype=Newspaper"
        alt=""><br>
    <img src="http://periodika.lv/periodika2-viewer/view/img/block?block=P1_TB00009&issue=/p_001_lavs1923n026&article=DIVL13&quality=&doctype=Newspaper"
        alt="">

    <ul>
        <li>"ğ”°", "Å¿" un "Å¿Ì·" lietojums. NedalÄm salikteÅ†us, kÄ rezultÄtÄ ignorÄ“jam "ğ”°" parÄdÄ«Å¡anos vÄrda vidÅ«.</li>
        <li>Windows lietotÄjiem viss izskatÄs slikti (iepriekÅ¡ minÄ“tie "Å¿" un "Å¿Ì·")</li>
        <li>Nav vÄ“l pabeigts, ir daudz visÄdu nianÅ¡u (lielie burti, utt)</li>
        <li>Un, vispÄr. VecÄ ortogrÄfija bija <a
                href="http://gramatas.lndb.lv/periodika2-viewer/view/index-dev.html?lang=fr#panel:pp|issue:/g_001_0304052338|article:DIVL270|page:50|issueType:B">kiÅ¡miÅ¡s
                ar rozÄ«nÄ“m</a>.</li>
    </ul>


    <script>
        const LETTER_SMALL = 0;
        const LETTER_CAPITAL = 1;

        const COMBINING_SHORT_SOLIDUS = '\u0337';
        const COMBINING_LONG_SOLIDUS = '\u0338';
        const COMBINING_CIRCUMFLEX_ACCENT = '\u0302';

        let latinToFraktur = [
            // SÄkam ar parastu burtu aizvietoÅ¡anu
            ['a', 'ğ”', LETTER_SMALL],
            ['b', 'ğ”Ÿ', LETTER_SMALL],
            ['c', 'ğ”·', LETTER_SMALL], // Ne "ğ” "
            ['d', 'ğ”¡', LETTER_SMALL],
            ['e', 'ğ”¢', LETTER_SMALL],
            ['f', 'ğ”£', LETTER_SMALL],
            ['g', 'ğ”¤', LETTER_SMALL],
            ['h', 'ğ”¥', LETTER_SMALL],
            ['i', 'ğ”¦', LETTER_SMALL],
            ['j', 'ğ”§', LETTER_SMALL],
            ['k', 'ğ”¨', LETTER_SMALL],
            ['l', 'ğ”©', LETTER_SMALL],
            ['m', 'ğ”ª', LETTER_SMALL],
            ['n', 'ğ”«', LETTER_SMALL],
            ['o', 'ğ”¬', LETTER_SMALL],
            ['p', 'ğ”­', LETTER_SMALL],
            ['q', 'ğ”®', LETTER_SMALL],
            ['r', 'ğ”¯', LETTER_SMALL],
            ['s', 'Å¿' + COMBINING_SHORT_SOLIDUS, LETTER_SMALL], // Å is nudien izskatÄs mega tizli. 
            ['t', 'ğ”±', LETTER_SMALL],
            ['u', 'ğ”²', LETTER_SMALL],
            ['v', 'ğ”´', LETTER_SMALL],
            ['w', 'ğ”´', LETTER_SMALL],
            ['x', 'ğ”µ', LETTER_SMALL],
            ['y', 'ğ”¶', LETTER_SMALL],
            ['z', 'Å¿', LETTER_SMALL], // Ne "ğ”·"

            ['A', 'ğ”„', LETTER_CAPITAL],
            ['B', 'ğ”…', LETTER_CAPITAL],
            ['C', 'â„¨', LETTER_CAPITAL], // Ne 'â„­'
            ['D', 'ğ”‡', LETTER_CAPITAL],
            ['E', 'ğ”ˆ', LETTER_CAPITAL],
            ['F', 'ğ”‰', LETTER_CAPITAL],
            ['G', 'ğ”Š', LETTER_CAPITAL],
            ['H', 'â„Œ', LETTER_CAPITAL],
            ['I', 'â„‘', LETTER_CAPITAL],
            ['J', 'ğ”', LETTER_CAPITAL],
            ['K', 'ğ”', LETTER_CAPITAL],
            ['L', 'ğ”', LETTER_CAPITAL],
            ['M', 'ğ”', LETTER_CAPITAL],
            ['N', 'ğ”‘', LETTER_CAPITAL],
            ['O', 'ğ”’', LETTER_CAPITAL],
            ['P', 'ğ”“', LETTER_CAPITAL],
            ['Q', 'ğ””', LETTER_CAPITAL],
            ['R', 'â„œ', LETTER_CAPITAL],
            ['S', 'ğ”–', LETTER_CAPITAL],
            ['T', 'ğ”—', LETTER_CAPITAL],
            ['U', 'ğ”˜', LETTER_CAPITAL],
            ['V', 'ğ”š', LETTER_CAPITAL],
            ['W', 'ğ”š', LETTER_CAPITAL],
            ['X', 'ğ”›', LETTER_CAPITAL],
            ['Y', 'ğ”œ', LETTER_CAPITAL],
            ['Z', 'ğ”–', LETTER_CAPITAL],

            // ÄªpatnÄ«bas
            // ['z', 's'],
            // ['dz', 'ds'],

            // Diaktrika ğ”Ì‚ğ”¢Ì‚ğ”¦Ì‚ğ”¬Ì‚ğ”²Ì‚ ğ”Ì€ğ”¢Ì€ğ”¦Ì€ğ”¬Ì€ğ”²Ì€
            ['Ä', 'ğ”' + COMBINING_CIRCUMFLEX_ACCENT, LETTER_SMALL],
            ['Ä“', 'ğ”¢' + COMBINING_CIRCUMFLEX_ACCENT, LETTER_SMALL],
            ['Ä', 'ğ”±Å¿ğ” ğ”¥', LETTER_SMALL],
            ['Ä£', 'ğ”¤' + COMBINING_SHORT_SOLIDUS, LETTER_SMALL],
            ['Ä«', 'ğ”¦' + COMBINING_CIRCUMFLEX_ACCENT, LETTER_SMALL],
            ['Ä·', 'ğ”¨' + COMBINING_SHORT_SOLIDUS, LETTER_SMALL],
            ['Ä¼', 'ğ”©' + COMBINING_SHORT_SOLIDUS, LETTER_SMALL],
            ['Å†', 'ğ”«' + COMBINING_SHORT_SOLIDUS, LETTER_SMALL],
            ['Å¡', 'Å¿ğ” ğ”¥', LETTER_SMALL],
            ['Å«', 'ğ”²' + COMBINING_CIRCUMFLEX_ACCENT, LETTER_SMALL],
            ['Å¾', 'Å¿ğ” ğ”¥', LETTER_SMALL],

            ['Ä€', 'ğ”„' + COMBINING_CIRCUMFLEX_ACCENT, LETTER_CAPITAL],
            ['Ä’', 'ğ”ˆ' + COMBINING_CIRCUMFLEX_ACCENT, LETTER_CAPITAL],
            ['ÄŒ', 'ğ”—Å¿ğ” ğ”¥', LETTER_CAPITAL], // @TODO
            ['Ä¢', 'ğ”Š' + COMBINING_LONG_SOLIDUS, LETTER_CAPITAL],
            ['Äª', 'â„‘' + COMBINING_CIRCUMFLEX_ACCENT, LETTER_CAPITAL],
            ['Ä¶', 'ğ”' + COMBINING_LONG_SOLIDUS, LETTER_CAPITAL],
            ['Ä»', 'ğ”' + COMBINING_LONG_SOLIDUS, LETTER_CAPITAL],
            ['Å…', 'ğ”‘' + COMBINING_LONG_SOLIDUS, LETTER_CAPITAL],
            ['Å ', 'ğ”–ğ” ğ”¥', LETTER_CAPITAL], // @TODO
            ['Åª', 'ğ”˜' + COMBINING_CIRCUMFLEX_ACCENT, LETTER_CAPITAL],
            ['Å½', 'ğ”–ğ” ğ”¥', LETTER_CAPITAL], // @TODO

        ];

        // RegExp, kas satur visus iespÄ“jamos burtus (word boundary vajadzÄ«bÄm)
        let boundary = latinToFraktur.map((e) => e[1]).join('|')
        // RegExp, kas satur visus lielos burtus.
        let capitals = latinToFraktur.filter((e) => e[2] === LETTER_CAPITAL && e[1].replace(COMBINING_CIRCUMFLEX_ACCENT, '').length < 3).map(e => e[1]).join('|')

        let input = document.getElementById('input');
        let output = document.getElementById('output');

        function gothme() {
            output.value = Goth(input.value);
        }

        input.addEventListener('input', gothme)
        gothme();

        // VienkÄrÅ¡Äkai dzÄ«vei.
        Object.assign(String.prototype, {
            isUpperCase() {
                return this.toUpperCase() === this.toString();
            },
        });

        function Goth(str) {
            let ret = str;

            // Pirmais solis - tupa visu repleisojam.
            latinToFraktur.forEach((val) => {
                ret = ret.replace(new RegExp(val[0], 'g'), val[1]);
            })

            // VÄrdu beigÄs viss ir savÄdÄk. Visur ir transliterÄcija, izÅ†emot vÄrdu beigas (un vÄ“l daÅ¾i gadÄ«jumi, kurus ignorÄ“ju)
            ret = ret.replace(new RegExp('ğ”Ì‚(' + boundary + ')', 'g'), 'ğ”ğ”¥$1');
            ret = ret.replace(new RegExp('ğ”¢Ì‚(' + boundary + ')', 'g'), 'ğ”¢ğ”¥$1');
            ret = ret.replace(new RegExp('ğ”¦Ì‚(' + boundary + ')', 'g'), 'ğ”¦ğ”¥$1');
            ret = ret.replace(new RegExp('ğ”²Ì‚(' + boundary + ')', 'g'), 'ğ”²ğ”¥$1');
            // Tas pats, kas iepriekÅ¡, tikai lielajiem burtiem
            ret = ret.replace(new RegExp('ğ”„Ì‚(' + boundary + ')', 'g'), 'ğ”„ğ”¥$1');
            ret = ret.replace(new RegExp('ğ”ˆÌ‚(' + boundary + ')', 'g'), 'ğ”ˆğ”¥$1');
            ret = ret.replace(new RegExp('â„‘Ì‚(' + boundary + ')', 'g'), 'â„‘ğ”¥$1');
            ret = ret.replace(new RegExp('ğ”˜Ì‚(' + boundary + ')', 'g'), 'ğ”˜ğ”¥$1');
            // VÄrda beigÄs ir smukais s, nevis garais vai garais Å¡vÄ«kotais. Un vÄ“l daÅ¾i gadÄ«jumi, kurus ignorÄ“ju.
            ret = ret.replace(new RegExp('Å¿Ì·(?!' + boundary + ')', 'g'), 'ğ”°'); // Negative look-ahead FTW
            // Pirms t un p ir garais s bez Å¡vÄ«kojuma
            ret = ret.replace(/Å¿Ì·([tp])/g, 'Å¿$1');
            // Ie -> ee
            ret = ret.replace(new RegExp('ğ”¦ğ”¢', 'g'), 'ğ”¢ğ”¢');
            ret = ret.replace(new RegExp('â„‘ğ”ˆ', 'g'), 'ğ”ˆğ”ˆ');

            // Dubultais s (zelZSceÄ¼Å¡)
            ret = ret.replace(new RegExp('Å¿Å¿Ì·', 'g'), 'Å¿ğ”°');

            // KombinÄ“tie (tsch, sch) jÄpalielina, ja tiem seko lielais burts.
            ret = ret.replace(new RegExp('ğ”—Å¿ğ” ğ”¥(' + capitals + ')', 'g'), 'ğ”—â„­â„Œ$1');
            ret = ret.replace(new RegExp('ğ”–ğ” ğ”¥(' + capitals + ')', 'g'), 'ğ”–â„­â„Œ$1');
            // Ja Eh seko lielais burts, palieilinam EH.
            ret = ret.replace(new RegExp('(ğ”„|ğ”ˆ|â„‘|ğ”˜)ğ”¥(' + capitals + ')', 'g'), '$1â„Œ$2');
            // Divreiz, jo nesapratu - daÅ¾reiz neiziet 'g' flags.
            ret = ret.replace(new RegExp('(ğ”„|ğ”ˆ|â„‘|ğ”˜)ğ”¥(' + capitals + ')', 'g'), '$1â„Œ$2');

            // Mazais 's' ideÄlajÄ pasaulÄ“ pÄ“c visiem senlatvieÅ¡u fenÅ¡ui:
            // - VÄrda sÄkumÄ Å¡vÄ«kotais garais. (Savus, SÄ“dÄ“)
            // - PÄ“c priedÄ“Ä·Ä¼a Å¡vÄ«kotais garais (atSaukdama, ieSniegti)
            // - VÄrda beigÄs "s" (buhS, taS)
            // - VÄrda vidÅ« parastais garais (miniStru)
            // - "Z" ir parastais garais (beZ, iZmantot)
            // - DaudzskaÅ†os Å¡vÄ«kotais garais (sch)
            // - NeidentificÄ“tos gadÄ«jumos Å¡vÄ«kotais garais (piepraSijumiem, puSes, utt)



            return ret;
        }

        const tests = [
            ['Papildu budÅ¾ets.', 'ğ”“ğ”ğ”­ğ”¦ğ”©ğ”¡ğ”² ğ”Ÿğ”²ğ”¡Å¿ğ” ğ”¥ğ”¢ğ”±ğ”°.'],
            ['Ministru kabinets wkardienas sÄ“dÄ“', 'ğ”ğ”¦ğ”«ğ”¦Å¿Ì·ğ”±ğ”¯ğ”² ğ”¨ğ”ğ”Ÿğ”¦ğ”«ğ”¢ğ”±ğ”° ğ”´ğ”¨ğ”ğ”¯ğ”¡ğ”¢ğ”¢ğ”«ğ”ğ”° Å¿Ì·ğ”¢ğ”¥ğ”¡ğ”¢Ì‚'],
            ['LÄpÄ', 'ğ”ğ”ğ”¥ğ”­ğ”Ì‚'],
            ['Å odien', 'ğ”–ğ” ğ”¥ğ”¬ğ”¡ğ”¢ğ”¢ğ”«'],
            ['Å ODIEN', 'ğ”–â„­â„Œğ”’ğ”‡ğ”ˆğ”ˆğ”‘'],
            ['CiktÄÄ¼', 'â„¨ğ”¦ğ”¨ğ”±ğ”ğ”¥ğ”©Ì·'],
            ['Ä€Ä’ÄªÅª', 'ğ”„â„Œğ”ˆâ„Œâ„‘â„Œğ”˜' + COMBINING_CIRCUMFLEX_ACCENT],
            ['Bez Å¡aubÄm', 'ğ”…ğ”¢Å¿ Å¿ğ” ğ”¥ğ”ğ”²ğ”Ÿğ”ğ”¥ğ”ª']
        ];

        tests.forEach((test) => {
            const actual = Goth(test[0]);
            const pass = test[1] === actual;
            const common_style = 'color: white; padding: .15rem .3rem; font-weight: bold;';
            console.log('%c' + (pass ? 'âœ“' : 'âœ•'), pass ? 'background-color: green;' + common_style : 'background-color: red;' + common_style, test[0], '=>', test[1], (!pass ? '(got: ' + actual + ')' : ''));
        })

    </script>
</body>

</html>